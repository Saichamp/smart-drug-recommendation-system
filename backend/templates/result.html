<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drug Recommendation Result</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <style>
        .recommendation-card {
            border: 2px solid #28a745;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .warning-badge {
            font-size: 0.9rem;
        }
        .print-btn {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container my-5">
        
        <!-- Header -->
        <div class="text-center mb-5">
            <h1 class="display-4">Drug Recommendation Result</h1>
            <p class="text-muted">AI-Powered Clinical Decision Support</p>
        </div>
        
        <!-- Critical Warnings First (if emergency) -->
        {% if 'üö®' in recommendation.drug_name or 'EMERGENCY' in recommendation.drug_name %}
        <div class="alert alert-danger border-danger mb-4" role="alert">
            <h3 class="alert-heading">üö® EMERGENCY ALERT</h3>
            <hr>
            <p class="mb-0"><strong>Immediate medical attention required. Do not proceed with self-medication.</strong></p>
        </div>
        {% endif %}
        
        <!-- Recommended Drug Card -->
        <div class="card recommendation-card mb-4">
            <div class="card-header bg-success text-white">
                <h3 class="mb-0">üíä Recommended Drug</h3>
            </div>
            <div class="card-body">
                <h2 class="text-success mb-3">{{ recommendation.drug_name }}</h2>
                
                {% if recommendation.dosage %}
                <div class="alert alert-light border-success mb-3">
                    <strong>üìã Dosage:</strong> {{ recommendation.dosage }}
                </div>
                {% endif %}
                
                <p class="lead"><strong>Reason for Selection:</strong></p>
                <p>{{ recommendation.reason }}</p>
            </div>
        </div>
        
        <!-- Alternative Drugs -->
        {% if recommendation.alternatives %}
        <div class="card mb-4 shadow-sm">
            <div class="card-header bg-info text-white">
                <h4 class="mb-0">üîÑ Alternative Options</h4>
            </div>
            <div class="card-body">
                <p class="text-muted">Consider these alternatives if primary drug is unavailable or unsuitable:</p>
                <ul class="list-group list-group-flush">
                    {% for alt in recommendation.alternatives %}
                    <li class="list-group-item">‚úì {{ alt }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        {% endif %}
        
        <!-- Safety Warnings -->
        {% if recommendation.warnings %}
        <div class="card mb-4 border-warning shadow-sm">
            <div class="card-header bg-warning text-dark">
                <h4 class="mb-0">‚ö†Ô∏è Safety Warnings & Contraindications</h4>
            </div>
            <div class="card-body">
                <p class="text-muted mb-3">Critical safety information - review carefully before prescribing:</p>
                {% for warning in recommendation.warnings %}
                <div class="alert alert-warning warning-badge mb-2" role="alert">
                    {{ warning }}
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        
        <!-- Precautions -->
        {% if recommendation.precautions %}
        <div class="card mb-4 shadow-sm">
            <div class="card-header bg-primary text-white">
                <h4 class="mb-0">üìå Precautions & Instructions</h4>
            </div>
            <div class="card-body">
                <ul>
                    {% for precaution in recommendation.precautions %}
                    <li>{{ precaution }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        {% endif %}
        
        <!-- Patient Summary -->
        <div class="card mb-4 shadow-sm">
            <div class="card-header bg-secondary text-white">
                <h4 class="mb-0">üë§ Patient Summary</h4>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Age:</strong> {{ patient.age }} years</p>
                        <p><strong>Gender:</strong> {{ patient.gender|capitalize }}</p>
                        {% if patient.weight %}
                        <p><strong>Weight:</strong> {{ patient.weight }} kg</p>
                        {% endif %}
                    </div>
                    <div class="col-md-6">
                        <p><strong>Symptoms:</strong> 
                            {% if patient.symptoms %}
                                {{ patient.symptoms|join(', ')|replace('_', ' ')|title }}
                            {% else %}
                                <span class="text-muted">None reported</span>
                            {% endif %}
                        </p>
                        <p><strong>Known Conditions:</strong> 
                            {% if patient.conditions %}
                                {{ patient.conditions|join(', ')|replace('_', ' ')|title }}
                            {% else %}
                                <span class="text-muted">None</span>
                            {% endif %}
                        </p>
                    </div>
                </div>
                
                {% if patient.allergies %}
                <div class="alert alert-danger mt-3 mb-0">
                    <strong>üö´ Drug Allergies:</strong> {{ patient.allergies }}
                </div>
                {% endif %}
                
                {% if patient.current_meds %}
                <div class="alert alert-info mt-3 mb-0">
                    <strong>üíä Current Medications:</strong> {{ patient.current_meds }}
                </div>
                {% endif %}
                
                <!-- Lab Values -->
                {% if patient.blood_sugar or patient.creatinine or patient.blood_pressure or patient.hemoglobin %}
                <hr class="my-3">
                <h5>üî¨ Lab Values</h5>
                <div class="row">
                    {% if patient.blood_sugar %}
                    <div class="col-md-3">
                        <strong>Blood Sugar:</strong><br>
                        <span class="badge bg-info">{{ patient.blood_sugar }} mg/dL</span>
                    </div>
                    {% endif %}
                    {% if patient.creatinine %}
                    <div class="col-md-3">
                        <strong>Creatinine:</strong><br>
                        <span class="badge bg-info">{{ patient.creatinine }} mg/dL</span>
                    </div>
                    {% endif %}
                    {% if patient.blood_pressure %}
                    <div class="col-md-3">
                        <strong>Blood Pressure:</strong><br>
                        <span class="badge bg-info">{{ patient.blood_pressure }}</span>
                    </div>
                    {% endif %}
                    {% if patient.hemoglobin %}
                    <div class="col-md-3">
                        <strong>Hemoglobin:</strong><br>
                        <span class="badge bg-info">{{ patient.hemoglobin }} g/dL</span>
                    </div>
                    {% endif %}
                </div>
                {% endif %}
            </div>
        </div>
        
        <!-- Disclaimer -->
        <div class="alert alert-light border mb-4">
            <small class="text-muted">
                <strong>Disclaimer:</strong> This recommendation is generated by an AI-based clinical decision support system. 
                It is intended to assist healthcare professionals and should not replace clinical judgment. 
                Always verify with current medical guidelines and consider individual patient factors before prescribing.
            </small>
        </div>
        
        <!-- Action Buttons -->
        <div class="d-grid gap-2 d-md-flex justify-content-md-center print-btn">
            <a href="/" class="btn btn-primary btn-lg px-5">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-circle" viewBox="0 0 16 16">
                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                    <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                </svg>
                New Recommendation
            </a>
            <button onclick="window.print()" class="btn btn-outline-secondary btn-lg px-5">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-printer" viewBox="0 0 16 16">
                    <path d="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"/>
                    <path d="M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"/>
                </svg>
                Print Result
            </button>
        </div>
        
    </div>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
